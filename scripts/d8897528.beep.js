var Beep={VERSION:6,AudioContext:window.AudioContext?window.AudioContext:window.webkitAudioContext,voices:[],triggers:[],instruments:[],domContainer:null,isKeyboarding:!0,setupTasks:[function(){void 0===Beep.audioContext&&(Beep.audioContext=new Beep.AudioContext)},function(){null===Beep.domContainer&&(Beep.domContainer=document.getElementById("beep"))}],setup:function(){for(var a;a=this.setupTasks.shift();)"function"==typeof a&&a()},teardown:function(){for(;this.instruments.length;)this.instruments.pop().teardown();for(;this.triggers.length;)this.triggers.pop().teardown();for(;this.voices.length;)this.voices.pop().teardown()},reset:function(){this.teardown(),this.setup()},parseMultilineString:function(a){a=a.toString();var b=a.indexOf("/*")+2,c=a.indexOf("*/",b);return a.substring(b,c).replace(/\/\+/g,"/*").replace(/\+\//g,"*/")}};document.addEventListener("DOMContentLoaded",function(){Beep.setup()}),Beep.Note=function(a){var b=this;if("number"==typeof a)this.hertz=a;else{if("object"!=typeof a||void 0===a.hertz)return Beep.Note.EDO12(a);Object.keys(a).forEach(function(c){b[c]=a[c]})}},Beep.Note.validateWestern=function(a){function b(a){return a.letterIndex<0&&(a.letterIndex+=e.length,a.octaveIndex--),a.letterIndex>=e.length&&(a.letterIndex-=e.length),a.letter=e.substr(a.letterIndex,1),a}var c,d=["A♭","A♮","B♭","B♮","C♮","C♯","D♮","E♭","E♮","F♮","F♯","G♮"],e="ABCDEFG",f="CF",g="EAB";return"undefined"==typeof a?a={}:"string"==typeof a&&(c=a,a={},c.split("").forEach(function(b,c){+b+""!="NaN"?a.octaveIndex=+b:-1!=="♭♮♯#".indexOf(b)?a.modifier=b:-1!==(e+"H").indexOf(b.toUpperCase())&&("H"===b.toUpperCase()?a.letter="B":"b"===b&&c>0?a.modifier="♭":a.letter=b.toUpperCase())})),(void 0===a.octaveIndex||""===a.octaveIndex||+a.octaveIndex+""=="NaN")&&(a.octaveIndex=4),a.octaveIndex=+a.octaveIndex,a.octaveIndex<0?a.octaveIndex=0:a.octaveIndex>8&&(a.octaveIndex=8),void 0===a.letter&&(a.letter="A"),a.letterIndex=e.indexOf(a.letter),void 0===a.modifier&&(a.modifier="♮"),void 0===a.A&&(a.A=440),"b"===a.modifier&&(a.modifier="♭"),"#"===a.modifier&&(a.modifier="♯"),"♭"===a.modifier&&-1===g.indexOf(a.letter)?(a.letterIndex=e.indexOf(a.letter)-1,a=b(a),f.indexOf(a.letter)>-1?a.modifier="♯":a.modifier="♮"):"♯"===a.modifier&&-1===f.indexOf(a.letter)&&(a.letterIndex=e.indexOf(a.letter)+1,a=b(a),g.indexOf(a.letter)>-1?a.modifier="♭":a.modifier="♮"),"♯"===a.modifier?a.isSharp=!0:"♭"===a.modifier?a.isFlat=!0:a.isNatural=!0,a=b(a),a.name=a.letter+a.modifier,a.nameSimple=a.letter,"♮"!==a.modifier&&(a.nameSimple+=a.modifier),a.nameIndex=d.indexOf(a.name),8===a.octaveIndex&&"C"!==a.nameSimple&&(a.octaveIndex=7),a.pianoKeyIndex=12*a.octaveIndex+a.nameIndex,a.nameIndex>3&&(a.pianoKeyIndex-=12),a.midiNumber=a.pianoKeyIndex+20,void 0===a.tuning&&(a.tuning="EDO12"),a},Beep.Note.EDO12=function(a){return a=Beep.Note.validateWestern(a),a.hertz=a.A*Math.pow(Math.pow(2,1/12),a.pianoKeyIndex-49),a.tuning="EDO12",new Beep.Note(a)},Beep.Note.JustIntonation=function(a,b){var c;return a=Beep.Note.validateWestern(a),a.tuning="JustIntonation",a.key=new Beep.Note.EDO12(b),c=(a.nameIndex-a.key.nameIndex)%12,0>c&&(c+=12),a.hertz=[a.key.hertz,16*a.key.hertz/15,9*a.key.hertz/8,6*a.key.hertz/5,5*a.key.hertz/4,4*a.key.hertz/3,45*a.key.hertz/32,3*a.key.hertz/2,8*a.key.hertz/5,5*a.key.hertz/3,16*a.key.hertz/9,15*a.key.hertz/8,2*a.key.hertz][c],a.hertz=a.hertz*Math.pow(2,a.octaveIndex-a.key.octaveIndex),new Beep.Note(a)},Beep.Voice=function(a,b){a instanceof Beep.AudioContext||a instanceof GainNode?(a instanceof Beep.AudioContext?(this.audioContext=a,this.destination=a.destination):a instanceof GainNode&&(this.audioContext=a.audioContext,this.destination=a),b instanceof Beep.Note?this.note=b:this.note=new Beep.Note(b)):(a instanceof Beep.Note?this.note=a:this.note=new Beep.Note(a),b instanceof Beep.AudioContext?(this.audioContext=b,this.destination=b.destination):b instanceof GainNode?(this.audioContext=b.audioContext,this.destination=b):(this.audioContext=Beep.audioContext,this.destination=this.audioContext.destination)),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.gainNode.connect(this.destination),this.oscillator=this.audioContext.createOscillator(),this.oscillator.connect(this.gainNode),this.oscillator.type="sine",this.oscillator.frequency.value=this.note.hertz,this.delayDuration=0,this.attackGain=.3,this.attackDuration=.05,this.decayDuration=.05,this.sustainGain=.8,this.sustainDuration=1/0,this.releaseDuration=.1,this.isPlaying=!1,this.isTorndown=!1,Beep.voices.push(this)},Beep.Voice.prototype.play=function(a){var b=this,c=this.audioContext.currentTime,d=this.gainNode.gain.value;return void 0!==a&&(this.note=new Beep.Note(a)),this.oscillator.frequency.value=this.note.hertz,this.gainNode.gain.cancelScheduledValues(c),this.gainNode.gain.setValueAtTime(d,c),this.delayDuration&&this.gainNode.gain.setValueAtTime(d,c+this.delayDuration),this.gainNode.gain.linearRampToValueAtTime(this.attackGain,c+this.delayDuration+this.attackDuration),this.gainNode.gain.linearRampToValueAtTime(this.attackGain*this.sustainGain,c+this.delayDuration+this.attackDuration+this.decayDuration),this.isPlaying===!1&&(this.isPlaying=!0,this.oscillator.start(0)),this.sustainDuration!==1/0&&setTimeout(function(){b.pause()},c+this.delayDuration+this.attackDuration+1e3*this.sustainDuration),this},Beep.Voice.prototype.pause=function(){var a=this.audioContext.currentTime;return this.gainNode.gain.cancelScheduledValues(a),this.gainNode.gain.setValueAtTime(this.gainNode.gain.value,a),this.gainNode.gain.linearRampToValueAtTime(1e-4,a+this.releaseDuration),this.gainNode.gain.setValueAtTime(0,a+this.releaseDuration+1e-4),this},Beep.Voice.prototype.teardown=function(){return this.isTorndown===!1&&(this.isPlaying&&this.oscillator.stop(0),this.oscillator.disconnect(),this.isTorndown=!0),this},["delayDuration","attackGain","attackDuration","decayDuration","sustainGain","sustainDuration","releaseDuration"].forEach(function(a){var b=a.substr(0,1).toUpperCase()+a.substr(1);Beep.Voice.prototype["get"+b]=function(){return this[a]},Beep.Voice.prototype["set"+b]=function(b){return this[a]=b,this}}),Beep.Voice.prototype.getOscillatorType=function(){return this.oscillator.type},Beep.Voice.prototype.setOscillatorType=function(a){return this.oscillator.type=a,this},Beep.Trigger=function(){var a=this;Array.prototype.slice.call(arguments).forEach(function(b){b instanceof Beep.Instrument?a.instrument=b:b instanceof Function?a.createVoices=b:b instanceof Beep.Note?a.note=b:a.note=new Beep.Note(b)}),this.id=Date.now()+"-"+Math.round(1e10*Math.random()),this.instrument?this.audioContext=this.instrument.audioContext:this.audioContext=Beep.audioContext,void 0===this.note&&(this.note=new Beep.Note),this.engaged=!1,this.voices=[],this.createVoices(),this.domContainer=document.createElement("div"),this.domContainer.classList.add("trigger-container"),this.domContainer.classList.add(this.note.isSharp||this.note.isFlat?"unnatural":"natural"),this.domContainer.classList.add("name-index-"+this.note.nameIndex),this.domContainer.setAttribute("id","trigger-"+this.id),this.domNoteName=document.createElement("div"),this.domNoteName.classList.add("note-name"),this.domNoteName.innerHTML="<strong>"+this.note.nameSimple+"</strong>"+this.note.octaveIndex,this.domContainer.appendChild(this.domNoteName),this.domTrigger=document.createElement("div"),this.domTrigger.classList.add("trigger"),this.domContainer.appendChild(this.domTrigger),this.domCharsList=document.createElement("div"),this.domCharsList.classList.add("chars-list"),this.domTrigger.appendChild(this.domCharsList),this.instrument&&this.instrument.domTriggers?this.instrument.domTriggers.appendChild(this.domContainer):document.body.appendChild(this.domContainer),this.eventListeners=[],this.domTrigger.addEventListener("mouseenter",function(){a.engage("mouseenter")}),this.domTrigger.addEventListener("mouseleave",function(){a.disengage("mouseenter")}),this.domTrigger.addEventListener("touchstart",function(b){a.engage("touched"),b.preventDefault()}),this.domTrigger.addEventListener("touchend",function(b){a.disengage("touched"),b.preventDefault()}),this.midiNumber=this.note.midiNumber,navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then(function(b){b.inputs.size&&(a.midiInputs[0].onmidimessage=a.onMidiMessage.bind(a))}),Beep.triggers.push(this)},Beep.Trigger.prototype.addEventListener=function(a,b){this.eventListeners.push({type:a,action:b}),window.addEventListener(a,b)},Beep.Trigger.prototype.removeEventListener=function(a,b){window.removeEventListener(a,b)},Beep.Trigger.prototype.addTriggerChar=function(a){var b,c,d=this;return"string"==typeof a?(b=a.toUpperCase(),c=b.charCodeAt(0),"<"===b&&(c=188)):"number"==typeof a&&(c=a,b=String.fromCharCode(c),188===c&&(b="<")),this.addEventListener("keydown",function(a){var b=a.which||a.keyCode;!Beep.isKeyboarding||b!==c||a.metaKey||a.ctrlKey||d.engage("keydown-"+c)}),this.addEventListener("keyup",function(a){var b=a.which||a.keyCode;b!==c||a.metaKey||a.ctrlKey||d.disengage("keydown-"+c)}),this.domCharsList.innerHTML+="<br>"+b,this},Beep.Trigger.prototype.onMidiMessage=function(a){var b=a.data[0]>>4,c=15&a.data[0],d=a.data[1],e=a.data[2];null!==this.midiNumber&&this.midiNumber===d&&9!=c&&(8===b||9===b&&0===e?this.disengage("midi"):9===b&&(this.voices.forEach(function(a){a.setAttackGain(e/127)}),this.engage("midi")))},Beep.Trigger.prototype.createVoices=function(){this.voices.push(new Beep.Voice(this.note,this.audioContext).setOscillatorType("sine").setAttackGain(.2).setReleaseDuration(.2),new Beep.Voice(this.note.hertz/2,this.audioContext).setOscillatorType("square").setAttackDuration(.01).setAttackGain(.3))},Beep.Trigger.prototype.teardownVoices=function(){for(var a=this.voices.length;a--;)void 0!==this.voices[a]&&this.voices[a].teardown(),delete this.voices[a];return this.voices=[],this.engaged=!1,this},Beep.Trigger.prototype.play=function(){this.voices.forEach(function(a){a.play()})},Beep.Trigger.prototype.pause=function(){this.voices.forEach(function(a){a.pause()})},Beep.Trigger.prototype.engage=function(a){return this.engaged===!1&&(this.engaged=!0,this.eventType=a,this.domContainer.classList.add("engaged"),this.play()),this},Beep.Trigger.prototype.disengage=function(a){return this.engaged!==!0||this.eventType!==a&&"code"!==this.eventType||(this.engaged=!1,this.pause(),this.domContainer.classList.remove("engaged")),this},Beep.Trigger.prototype.teardown=function(){this.pause(),this.teardownVoices(),this.eventListeners.forEach(function(a){window.removeEventListener(a.type,a.action)}),this.eventListeners=[],this.domContainer.remove()},Beep.Instrument=function(){var a=this,b=document.getElementById("play-pause-container");Array.prototype.slice.call(arguments).forEach(function(b){b instanceof window.Element?a.domContainer=b:"string"==typeof b?a.domContainer=document.getElementById(b):b instanceof Function&&(a.createVoices=b)}),this.context=Beep.audioContext,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.gainNode.gain.value=.3,void 0===this.domContainer&&(this.domContainer=document.createElement("div")),this.domContainer.classList.add("instrument"),Beep.domContainer?Beep.domContainer.appendChild(this.domContainer):document.body.appendChild(this.domContainer),this.triggers={},this.domTriggers=document.createElement("div"),this.domTriggers.classList.add("triggers"),this.domContainer.appendChild(this.domTriggers),b||(b=this.domContainer),this.domScorePlayPause=document.createElement("img"),this.domScorePlayPause.classList.add("score-play-pause"),this.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#play"),b.appendChild(this.domScorePlayPause),this.domScorePlayPause.addEventListener("mouseenter",function(){a.scoreIsPlaying?a.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#pause-hover"):a.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#play-hover")}),this.domScorePlayPause.addEventListener("mouseleave",function(){a.scoreIsPlaying?a.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#pause"):a.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#play")}),this.domScorePlayPause.addEventListener("click",function(){a.scoreToggle()}),this.domScorePlayPause.addEventListener("touchend",function(b){a.scoreToggle(),b.preventDefault()}),window.addEventListener("keypress",function(b){var c=b.which||b.keyCode;Beep.isKeyboarding&&(32===c?(a.scoreToggle(),b.preventDefault()):13===c&&b.shiftKey&&a.scoreIsPlaying===!1&&(Object.keys(a.triggers).length?a.unbuild():a.build(),b.preventDefault()))}),this.domContainer.addEventListener("touchmove",function(b){Array.prototype.slice.call(b.changedTouches).forEach(function(b){Object.keys(a.triggers).forEach(function(c){var d=a.triggers[c],e=d.domTrigger.getBoundingClientRect();e.left<b.pageX&&b.pageX<e.right&&e.top<b.pageY&&b.pageY<e.bottom?d.engage("touched"):d.disengage("touched")})}),b.preventDefault()}),this.domContainer.addEventListener("touchend",function(b){Object.keys(a.triggers).forEach(function(b){a.triggers[b].disengage("touched")})}),this.bpm=140,this.beatsPerBar=4,this.oneBeat=.25,this.beats=0,this.timePrevious=0,this.scoreCompleted=[],this.scoreRemaining=[],this.scoreIsPlaying=!1,this.build(),Beep.instruments.push(this)},Beep.Instrument.prototype.addStyleClass=function(a){return this.domContainer.classList.add(a),this},Beep.Instrument.prototype.removeStyleClass=function(a){return this.domContainer.classList.remove(a),this},Beep.Instrument.prototype.teardown=function(){this.unbuild(),this.gainNode.disconnect(),this.domScorePlayPause.remove(),this.domTriggers.remove(),this.domContainer.remove()},Beep.Instrument.prototype.newTrigger=function(a,b){var c;return a instanceof Beep.Note==!1&&(a=new Beep.Note(a)),c=void 0!==this.createVoices?new Beep.Trigger(this,a,this.createVoices):new Beep.Trigger(this,a),b instanceof Array==!1&&(b=[b]),b.forEach(function(a){void 0!==a&&c.addTriggerChar(a)}),this.triggers[a.octaveIndex+a.nameSimple]=c,this},Beep.Instrument.prototype.play=function(a){var b=Object.keys(this.triggers),c=Math.floor(b.length/2);return void 0===a&&(a=b[c]),"string"==typeof a&&this.triggers[a]&&(a=this.triggers[a]),a instanceof Beep.Trigger&&a.engage("code"),this},Beep.Instrument.prototype.pause=function(a){var b=this;return"string"==typeof a&&this.triggers[a]&&(a=this.triggers[a]),a instanceof Beep.Trigger&&a.disengage(),void 0===a&&Object.keys(this.triggers).forEach(function(a){b.triggers[a].disengage()}),this},Beep.Instrument.prototype.applyVoices=function(a){var b=this;return this.createVoices=a,Object.keys(this.triggers).forEach(function(c){c=b.triggers[c],c.teardownVoices(),c.createVoices=a,c.createVoices()}),this},Beep.Instrument.prototype.buildStandard=function(){return this.unbuild().newTrigger("3C","z").newTrigger("3C♯","s").newTrigger("3D","x").newTrigger("3E♭","d").newTrigger("3E","c").newTrigger("3F","v").newTrigger("3F♯","g").newTrigger("3G","b").newTrigger("3A♭","h").newTrigger("3A","n").newTrigger("3B♭","j").newTrigger("3B","m").newTrigger("4C",["q","<"]).newTrigger("4C♯","2").newTrigger("4D","w").newTrigger("4E♭","3").newTrigger("4E","e").newTrigger("4F","r").newTrigger("4F♯","5").newTrigger("4G","t").newTrigger("4A♭","6").newTrigger("4A","y").newTrigger("4B♭","7").newTrigger("4B","u").newTrigger("5C","i"),this.scoreLoadDoReMi(),this.scoreLoadFromHash(),this},Beep.Instrument.prototype.buildCloseEncounters=function(){return this.unbuild().newTrigger("4G","1").newTrigger("4A","2").newTrigger("4F","3").newTrigger("3F","4").newTrigger("4C","5"),this},Beep.Instrument.prototype.buildCloseEncountersJust=function(){return this.unbuild().newTrigger(new Beep.Note.JustIntonation("4G","4C"),"1").newTrigger(new Beep.Note.JustIntonation("4A","4C"),"2").newTrigger(new Beep.Note.JustIntonation("4F","4C"),"3").newTrigger(new Beep.Note.JustIntonation("3F","4C"),"4").newTrigger(new Beep.Note.JustIntonation("4C","4C"),"5"),this},Beep.Instrument.prototype.buildJustVsEDO12=function(){return this.unbuild().newTrigger("4C","1").newTrigger("4D","2").newTrigger("4A","3").newTrigger(new Beep.Note.JustIntonation("4C","4C"),"7").newTrigger(new Beep.Note.JustIntonation("4D","4C"),"8").newTrigger(new Beep.Note.JustIntonation("4A","4C"),"9"),this},Beep.Instrument.prototype.buildC=function(){return this.unbuild().newTrigger("3C","z").newTrigger("3C♯").newTrigger("3D","x").newTrigger("3E♭").newTrigger("3E","c").newTrigger("3F","v").newTrigger("3F♯").newTrigger("3G","b").newTrigger("3A♭").newTrigger("3A","n").newTrigger("3B♭").newTrigger("3B","m").newTrigger("4C",["a","<"]).newTrigger("4C♯").newTrigger("4D","s").newTrigger("4E♭").newTrigger("4E","d").newTrigger("4F","f").newTrigger("4F♯").newTrigger("4G","g").newTrigger("4A♭").newTrigger("4A","h").newTrigger("4B♭").newTrigger("4B","j").newTrigger("5C",["k","q"]).newTrigger("5C♯").newTrigger("5D","w").newTrigger("5E♭").newTrigger("5E","e").newTrigger("5F","r").newTrigger("5F♯").newTrigger("5G","t").newTrigger("5A♭").newTrigger("5A","y").newTrigger("5B♭").newTrigger("5B","u").newTrigger("6C",["i","1"]).newTrigger("6C♯").newTrigger("6D","2").newTrigger("6E♭").newTrigger("6E","3").newTrigger("6F","4").newTrigger("6F♯").newTrigger("6G","5").newTrigger("6A♭").newTrigger("6A","6").newTrigger("6B♭").newTrigger("6B","7").newTrigger("7C","8").domContainer.classList.add("mini"),this},Beep.Instrument.prototype.buildCRainbow=function(){return this.buildC(),this.domContainer.classList.add("rainbow"),this.scoreLoadDoReMi(),this.scoreLoadFromHash(),this},Beep.Instrument.prototype.buildCJust=function(){return this.unbuild().newTrigger(new Beep.Note.JustIntonation("3C","4C"),"z").newTrigger(new Beep.Note.JustIntonation("3C♯","4C")).newTrigger(new Beep.Note.JustIntonation("3D","4C"),"x").newTrigger(new Beep.Note.JustIntonation("3E♭","4C")).newTrigger(new Beep.Note.JustIntonation("3E","4C"),"c").newTrigger(new Beep.Note.JustIntonation("3F","4C"),"v").newTrigger(new Beep.Note.JustIntonation("3F♯","4C")).newTrigger(new Beep.Note.JustIntonation("3G","4C"),"b").newTrigger(new Beep.Note.JustIntonation("3A♭","4C")).newTrigger(new Beep.Note.JustIntonation("3A","4C"),"n").newTrigger(new Beep.Note.JustIntonation("3B♭","4C")).newTrigger(new Beep.Note.JustIntonation("3B","4C"),"m").newTrigger(new Beep.Note.JustIntonation("4C","4C"),["a","<"]).newTrigger(new Beep.Note.JustIntonation("4C♯","4C")).newTrigger(new Beep.Note.JustIntonation("4D","4C"),"s").newTrigger(new Beep.Note.JustIntonation("4E♭","4C")).newTrigger(new Beep.Note.JustIntonation("4E","4C"),"d").newTrigger(new Beep.Note.JustIntonation("4F","4C"),"f").newTrigger(new Beep.Note.JustIntonation("4F♯","4C")).newTrigger(new Beep.Note.JustIntonation("4G","4C"),"g").newTrigger(new Beep.Note.JustIntonation("4A♭","4C")).newTrigger(new Beep.Note.JustIntonation("4A","4C"),"h").newTrigger(new Beep.Note.JustIntonation("4B♭","4C")).newTrigger(new Beep.Note.JustIntonation("4B","4C"),"j").newTrigger(new Beep.Note.JustIntonation("5C","4C"),["k","q"]).newTrigger(new Beep.Note.JustIntonation("5C♯","4C")).newTrigger(new Beep.Note.JustIntonation("5D","4C"),"w").newTrigger(new Beep.Note.JustIntonation("5E♭","4C")).newTrigger(new Beep.Note.JustIntonation("5E","4C"),"e").newTrigger(new Beep.Note.JustIntonation("5F","4C"),"r").newTrigger(new Beep.Note.JustIntonation("5F♯","4C")).newTrigger(new Beep.Note.JustIntonation("5G","4C"),"t").newTrigger(new Beep.Note.JustIntonation("5A♭","4C")).newTrigger(new Beep.Note.JustIntonation("5A","4C"),"y").newTrigger(new Beep.Note.JustIntonation("5B♭","4C")).newTrigger(new Beep.Note.JustIntonation("5B","4C"),"u").newTrigger(new Beep.Note.JustIntonation("6C","4C"),["i","1"]).newTrigger(new Beep.Note.JustIntonation("6C♯","4C")).newTrigger(new Beep.Note.JustIntonation("6D","4C"),"2").newTrigger(new Beep.Note.JustIntonation("6E♭","4C")).newTrigger(new Beep.Note.JustIntonation("6E","4C"),"3").newTrigger(new Beep.Note.JustIntonation("6F","4C"),"4").newTrigger(new Beep.Note.JustIntonation("6F♯","4C")).newTrigger(new Beep.Note.JustIntonation("6G","4C"),"5").newTrigger(new Beep.Note.JustIntonation("6A♭","4C")).newTrigger(new Beep.Note.JustIntonation("6A","4C"),"6").newTrigger(new Beep.Note.JustIntonation("6B♭","4C")).newTrigger(new Beep.Note.JustIntonation("6B","4C"),"7").newTrigger(new Beep.Note.JustIntonation("7C","4C"),"8").domContainer.classList.add("mini"),this},Beep.Instrument.prototype.build=Beep.Instrument.prototype.buildStandard,Beep.Instrument.prototype.unbuild=function(){var a=this;return Object.keys(this.triggers).forEach(function(b){a.triggers[b].teardown(),delete a.triggers[b]}),this.domContainer.classList.remove("mini"),this.domContainer.classList.remove("rainbow"),this},Beep.Instrument.prototype.scoreLoadFromHash=function(){if(""!==document.location.hash){var score=document.location.hash.substr(1).split(",").map(function(element){var value;try{value=eval(element)}catch(error){}return value});this.scoreUnload(),this.scoreLoad(score)}},Beep.Instrument.prototype.scoreLoad=function(a){var b,c,d=0;for(b=0;b<a.length;b+=3)c=new Beep.Note(a[b+1]),d+=a[b+0]||0,this.scoreRemaining.push([d,c.octaveIndex+c.nameSimple,!0]),this.scoreRemaining.push([d+a[b+2],c.octaveIndex+c.nameSimple,!1]);return this.scoreRemaining.sort(function(a,b){return a[0]-b[0]}),this},Beep.Instrument.prototype.scorePlayLoop=function(){var a=window.performance&&window.performance.now,b=a?performance.now():Date.now(),c=b-this.timePrevious;for(0===this.timePrevious&&(c=1);this.scoreRemaining.length&&this.beats>=this.scoreRemaining[0][0];)this.scoreRemaining[0][2]?this.play(this.scoreRemaining[0][1]):this.pause(this.scoreRemaining[0][1]),this.scoreCompleted.push(this.scoreRemaining.shift());return this.beats+=this.bpm/60/c*this.oneBeat,this.timePrevious=b,0===this.scoreRemaining.length&&(this.scoreIsPlaying=!1,this.scoreRemaining=this.scoreRemaining.concat(this.scoreCompleted),this.scoreCompleted=[],this.beats=0,this.timePrevious=0,this.domScorePlayPause.classList.remove("is-playing")),this.scoreIsPlaying&&requestAnimationFrame(this.scorePlayLoop.bind(this)),this},Beep.Instrument.prototype.scorePlay=function(){return Object.keys(this.triggers).length&&(this.scoreIsPlaying=!0,this.scorePlayLoop(),this.domScorePlayPause.classList.add("is-playing")),this},Beep.Instrument.prototype.scoreStop=function(){return this.scoreIsPlaying=!1,this.pause(),this.domScorePlayPause.classList.remove("is-playing"),this},Beep.Instrument.prototype.scoreToggle=function(){var a=this;return this.scoreIsPlaying?(this.scoreStop(),this.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#play")):(this.scorePlay(),this.domScorePlayPause.setAttribute("src","beep/Beep.Instrument.svg#pause")),this.domScorePlayPause.style.marginRight="1px",window.setTimeout(function(){a.domScorePlayPause.style.marginRight="0"}),this},Beep.Instrument.prototype.scoreUnload=function(){this.scoreStop(),this.scoreCompleted=[],this.scoreRemaining=[],this.beats=0,this.timePrevious=0},Beep.Instrument.prototype.scoreLoadDoReMi=function(){var a=[9,"4C",1.5,1.5,"4D",.5,.5,"4E",5/4,1.5,"4C",.5,.5,"4E",1,1,"4C",.75,1,"4E",1,2,"4D",1.5,1.5,"4E",.5,.5,"4F",.25,.5,"4F",.25,.5,"4E",.5,.5,"4D",.5,.5,"4F",2,4,"4E",1.5,1.5,"4F",.5,.5,"4G",5/4,1.5,"4E",.5,.5,"4G",1,1,"4E",.75,1,"4G",1.5,2,"4F",1.5,1.5,"4G",.5,.5,"4A",.25,.5,"4A",.25,.5,"4G",.5,.5,"4F",.5,.5,"4A",2,4,"4G",1.5,1.5,"4C",.5,.5,"4D",.5,.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",3,4,"4A",1.5,1.5,"4D",.5,.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",.5,.5,"4B",3,4,"4B",1.5,1.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",.5,.5,"4B",.5,.5,"5C",3,3,"4A",.25,.5,"4A",.25,.5,"4A",.75,1,"4F",.75,1,"4B",.75,1,"4G",.75,1,"5C",2,1,"3C",1/16,1/16,"3D",1/16,1/16,"3C",1/16,1/16,"3E",1/16,1/16,"3F",1/16,1/16,"3G",1/16,1/16,"3A",1/16,1/16,"3B",1/16,1/16,"4C",1/16,1/16,"4D",1/16,1/16,"4C",1/16,1/16,"4E",1/16,1/16,"4F",1/16,1/16,"4G",1/16,1/16,"4A",1/16,1/16,"4B",1/16,1/16,"5C",2,.5,"4C",1.5,.5,"3C",1],b=[1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",1,1,"3B",.5,.5,"3A",.5,.5,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",1,1,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",1,1,"3B",.5,.5,"3A",.5,.5,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",.5,.5,"3G",.5,.5,"3C",.5,.5,"3A",.5,.5,"3F",.5,.5,"3E",.5,.5,"3C",.5,.5,"3D",1,1,"3G",.5,.5,"3C",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"4D",.5,.5,"4C",1];this.scoreUnload(),this.scoreLoad(a),this.scoreLoad(b)},Beep.Instrument.prototype.scoreLoadHSB=function(){var a=[1,"3A♭",.75,1,"4E♭",.75,1,"4A♭",.75,1,"4E♭",.75];this.scoreUnload(),this.scoreLoad(a)};